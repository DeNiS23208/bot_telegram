# Настройка автопродления подписки с сохранением карты

## Текущая реализация

Сейчас бот отправляет ссылку на оплату при истечении подписки, но автопродление с сохранением карты требует дополнительной настройки.

## Что нужно для автопродления

### 1. Использование Saved Payment Methods в ЮKassa

Для автопродления с сохранением карты нужно:

1. **При первой оплате** - сохранить payment_method_id
2. **При продлении** - использовать сохраненный payment_method_id для автоматического списания

### 2. Изменения в коде (требуются)

1. Добавить таблицу для хранения сохраненных методов оплаты
2. Сохранять payment_method_id при успешной оплате
3. Использовать сохраненный метод для автопродления

### 3. Настройка в ЮKassa

- Включить сохранение платежных методов в настройках магазина
- Настроить рекуррентные платежи (если доступно)

## Временное решение

Пока автопродление не настроено, бот:
- Отправляет уведомление за 3 дня до окончания подписки
- Отправляет ссылку на оплату при истечении подписки
- Пользователь может вручную продлить подписку

## Важно

Автопродление с сохранением карты требует:
- Согласие пользователя на сохранение карты
- Соответствие требованиям PCI DSS
- Правильную настройку в ЮKassa


