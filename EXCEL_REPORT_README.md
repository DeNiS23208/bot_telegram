# üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á–µ—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `generate_excel_report.py` —Å–æ–∑–¥–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π Excel –æ—Ç—á–µ—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞. –û—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `openpyxl`:
```bash
pip install openpyxl==3.1.2
```

–ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`:
```bash
pip install -r requirements.txt
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /opt/bot_telegram
source venv/bin/activate
python3 generate_excel_report.py
```

### –õ–æ–∫–∞–ª—å–Ω–æ:

```bash
cd /path/to/bot_telegram
python3 generate_excel_report.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞

Excel —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç 5 –ª–∏—Å—Ç–æ–≤:

### 1. **–°–≤–æ–¥–∫–∞** (–ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç)
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –û–±—â–∞—è —Å—É–º–º–∞
- –ü–ª–∞—Ç–µ–∂–∏ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
- –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ–º
- –î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞

### 2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**
- ID Telegram
- Username
- –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π

### 3. **–ü–ª–∞—Ç–µ–∂–∏**
- ID –ü–ª–∞—Ç–µ–∂–∞ (YooKassa)
- ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Username
- –°—Ç–∞—Ç—É—Å (—Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π):
  - ‚úÖ –£—Å–ø–µ—à–Ω–æ (–∑–µ–ª–µ–Ω—ã–π)
  - ‚è≥ –û–∂–∏–¥–∞–µ—Ç (–∂–µ–ª—Ç—ã–π)
  - ‚ùå –û—Ç–º–µ–Ω–µ–Ω / ‚è∞ –ò—Å—Ç–µ–∫ (–∫—Ä–∞—Å–Ω—ã–π)
- –°—É–º–º–∞ (—Ä—É–±)
- –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- –î–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°—Å—ã–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ (–î–∞/–ù–µ—Ç)

### 4. **–ü–æ–¥–ø–∏—Å–∫–∏**
- ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Username
- –ù–∞—á–∞–ª–æ –¥–æ—Å—Ç—É–ø–∞
- –û–∫–æ–Ω—á–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
- –°—Ç–∞—Ç—É—Å (–ê–∫—Ç–∏–≤–Ω–∞/–ò—Å—Ç–µ–∫–ª–∞ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π)
- –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ (–î–∞/–ù–µ—Ç)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞—Ä—Ç–∞ (–î–∞/–ù–µ—Ç)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–î–∞/–ù–µ—Ç)

### 5. **–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏**
- –°—Å—ã–ª–∫–∞
- ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Username
- ID –ü–ª–∞—Ç–µ–∂–∞
- –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- –°—Ç–∞—Ç—É—Å (–ê–∫—Ç–∏–≤–Ω–∞/–û—Ç–æ–∑–≤–∞–Ω–∞ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π)

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: –°–∏–Ω–∏–π —Ñ–æ–Ω, –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç, –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç
- **–¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è**:
  - –ó–µ–ª–µ–Ω—ã–π: —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
  - –ñ–ª—Ç—ã–π: –æ–∂–∏–¥–∞—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
  - –ö—Ä–∞—Å–Ω—ã–π: –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ/–∏—Å—Ç–µ–∫—à–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ì—Ä–∞–Ω–∏—Ü—ã**: –í—Å–µ —è—á–µ–π–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–º–µ—é—Ç –≥—Ä–∞–Ω–∏—Ü—ã
- **–®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è

## –ò–º—è —Ñ–∞–π–ª–∞

–û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å –∏–º–µ–Ω–µ–º: `bot_report_YYYYMMDD_HHMMSS.xlsx`

–ù–∞–ø—Ä–∏–º–µ—Ä: `bot_report_20251226_141901.xlsx`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

–û—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–∞**: –ù–∞–π–¥–∏—Ç–µ –ø–ª–∞—Ç–µ–∂ –ø–æ ID –≤ –ª–∏—Å—Ç–µ "–ü–ª–∞—Ç–µ–∂–∏"
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –ª–∏—Å—Ç–µ "–ü–æ–¥–ø–∏—Å–∫–∏"
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–∫–∏**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Å—ã–ª–∫–∞ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–µ –æ—Ç–æ–∑–≤–∞–Ω–∞
4. **–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª–∏—Å—Ç–µ "–ü–ª–∞—Ç–µ–∂–∏"

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—Å—Ç "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"
2. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID –∏–ª–∏ username
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ª–∏—Å—Ç "–ü–ª–∞—Ç–µ–∂–∏" –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π –∏ –ø–æ–¥–ø–∏—Å–æ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—Å—Ç "–ü–ª–∞—Ç–µ–∂–∏"
2. –ù–∞–π–¥–∏—Ç–µ –ø–ª–∞—Ç–µ–∂ –ø–æ ID (—Å—Ç–æ–ª–±–µ—Ü A)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å, –¥–∞—Ç—ã, —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ª–∏—Å—Ç "–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Å—ã–ª–∫–∏

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `DB_PATH` –∏–ª–∏ `bot.db` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –í—Å–µ –¥–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–î–î.–ú–ú.–ì–ì–ì–ì –ß–ß:–ú–ú:–°–°`
- –û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ

